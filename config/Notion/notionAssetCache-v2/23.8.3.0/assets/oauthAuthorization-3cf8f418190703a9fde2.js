(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"nra+":function(e,t,i){"use strict";i.r(t);var o=i("gcR/"),a=i.n(o),r=i("lSNA"),n=i.n(r),s=(i("3bBZ"),i("UxlC"),i("q1tI")),d=i.n(s),l=i("mF3+"),c=i("wldR"),h=i("Sb6f"),g=i("Ng05"),p=i("IULH"),u=i("hnPE"),m=i("pVnL"),S=i.n(m),v=i("+QMF"),y=i("2Y+N"),f=i("NSFP"),b=i("QcDD"),w=i("+fkW"),P=i("SiBm"),k=i("J9+s"),M=i("Rtjx"),A=i("JSZu"),x=i("qX+M"),C=i("BJyN"),I=i("ij+4"),T=i("w5Oa");class z extends I.b{renderAccountHeader(e){const t=P.a.getUserEmailAddress(this.environment,e);return t&&a()(f.a,{emailAddress:t,userId:e,disabled:!1,accountActions:[Object(C.i)(e)]})}renderFooter(){return a()("div",{style:this.getFooterStyle()},void 0,a()(y.a,{},void 0,v.b(this.environment)&&d.a.createElement(A.a,S()({createType:"add-account",disableLoginLink:this.props.disableLoginLink},this.stores))))}getMenuListSections(e){const{device:t}=this.environment;return[{key:"spaces",render:e=>d.a.createElement(y.a,S()({},e,{disableMobilePadding:!0,topBorder:t.isMobile,style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}})),items:this.getSpaceMenuListItems(e)}]}getSpaceMenuListItems(e){const{onSpaceClick:t}=this.props,i=[],{currentUserRootStore:o,currentSpaceStore:r}=b.default.state,n=P.a.getSpaceViewStores(this.environment,e);if(!o||!r)return[];n.sort((e,t)=>{var i,o;const a=Number(Boolean(null===(i=e.getSpaceStore())||void 0===i?void 0:i.canAdmin()));return Number(Boolean(null===(o=t.getSpaceStore())||void 0===o?void 0:o.canAdmin()))-a});for(const s of n){const n=s.getSpaceStore();if(n){const l=e===o.id&&n.id===r.id,c=Object(x.getSpaceName)(this.environment,n),h=n.canAdmin();let g;const p=w.a.getPublicSpaceData(this.environment,n.id);if(p){const e=p.productId?this.props.intl.formatMessage(Object(M.e)(p.productId)):this.props.intl.formatMessage("team"===n.getPlanType()?M.j.teamTrialPlan:M.j.personalPlan);g=this.props.intl.formatMessage("personal"===n.getPlanType()?M.j.workspaceSubtitleWithoutMembers:M.j.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(p.memberCount),planType:e})}i.push({key:s.id,render:e=>d.a.createElement(T.a,S()({},e,{id:s.id,icon:Object(x.getSpaceIcon)(this.environment,n),title:c,caption:g,isCheck:l,showDragHandle:!1,disabled:!h,disableTooltip:h,tooltipMessage:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.workspaceSwitcher.disabledWorkspace.tooltip",defaultMessage:"This integration can only be added by someone with Admin access."})})),action:async({event:e})=>{this.close(),l||await t({event:e,spaceViewStore:s})}})}}return i}getUnreadCountForOtherSpaces(){return 0}}var N=Object(k.injectIntl)(z),E=i("sdlW"),F=i("hU3F"),B=i("wlCD"),L=i("bPtJ"),O=i("CQbt"),j=i("nylu"),R=i("CSYU"),W=i("FUUC"),U=i("Pl3d"),_=i("G+Ai"),q=i("g90h"),D=i("PHZn"),H=i("zmp8"),V=i("zzAG"),G=i("pgQH"),Q=i("e28A"),Y=i("Oy36"),J=i("mXKa"),Z=i("qqdV"),X=i("H4VD"),K=i("3O7B"),$=i("IYZQ"),ee=i("LvDl"),te=i.n(ee),ie=i("HRSx"),oe=i("HTHG"),ae=i("wpmu"),re=i("2ZkR"),ne=i("SR/M"),se=i("3DNc"),de=i("yNyh"),le=i("WgIs"),ce=i("Na01"),he=i("OxuQ"),ge=i("n8tN");class pe extends ge.a{renderComponent(){const{isMobile:e,nestingLevel:t}=this.props;return d.a.createElement(ne.a,S()({},this.props,{title:a()(ce.a,{childrenStyle:pe.sidebarChildrenStyle,left:this.renderLeftCheckbox(),icon:this.renderIcon(),isMobile:e,style:{marginLeft:8*t}},void 0,this.renderTitle())}))}renderLeftCheckbox(){return a()(se.a,{size:16,checked:this.props.isChecked,onClick:this.props.onClick})}renderIcon(){const{store:e,isMobile:t}=this.props,i=e.getIcon();return a()(Y.a,{disabled:!0,icon:i,title:void 0,isEmptyPage:e.isEmptyPage(),size:t?24:20,pageIconStyle:{fill:this.theme.mediumIconColor}})}renderTitle(){return a()(he.a,{store:this.props.store})}}n()(pe,"sidebarChildrenStyle",{display:"flex",alignItems:"center"});var ue=pe,me=i("wXH4"),Se=i("mUbl"),ve=i("Zo/l"),ye=i("4HCU"),fe=i("gbGO");function be(e){const{spaceId:t,onSelectPage:i,query:o,source:r}=e,n=Object(ve.b)(),s=Object(D.b)();let l=null;const[{value:c}]=Object(Se.a)(async()=>await ye.h({environment:n,query:o,limit:10,requireEditPermissions:!0,spaceId:t,excludeTemplates:!0,source:r}),[n,o,t,r]);if(c&&0!==c.total){const e=c.results.map(({id:e})=>{const t=new ae.a(n,{table:ie.a,id:e});return{key:t.id,action:()=>i(t.id),render:e=>d.a.createElement(ne.a,S()({},e,{title:a()(ce.a,{icon:a()(Y.a,{disabled:!0,icon:t.getIcon(),title:void 0,isEmptyPage:t.isEmptyPage(),pageIconStyle:{fill:s.mediumIconColor},size:n.device.isMobile?24:20}),isMobile:n.device.isMobile},void 0,a()(he.a,{store:t}))}))}});l=a()(le.a,{type:le.a.Type.Vertical,initialFocus:void 0,sections:[{key:"results",items:e,render:e=>d.a.createElement(y.a,e)}]})}else l=a()("div",{},void 0,a()(k.FormattedMessage,{id:"pageSearchResults.noResults.placeholder",defaultMessage:"No results"}));const h={menuType:fe.b.MenuType.Popup};return d.a.createElement(fe.b,h,l)}class we extends c.a{constructor(...e){super(...e),n()(this,"sidebarState",this.createComputedStore(()=>Object(oe.j)(this.environment))),n()(this,"storeTypes",{selectedPageIdsStore:F.a.of(new Set),searchStore:F.a.of({open:!1,query:void 0})}),n()(this,"getPageItem",(e,t)=>{const{selectedPageIdsStore:i}=this.stores,{device:o}=this.environment,a=i.state.has(e.id);return{key:e.id,action:()=>this.props.onClickPage(e.id,a),render:i=>d.a.createElement(ue,S()({},i,{isMobile:o.isMobile,store:e,isChecked:a,disabled:!1,nestingLevel:t}))}}),n()(this,"getPageSectionHeader",(e,t)=>{const{selectedPageIdsStore:i}=this.stores,{device:o}=this.environment,r=t.length>0&&t.every(e=>i.state.has(e.id));return{key:e,action:()=>this.props.onClickSection(t),render:t=>d.a.createElement(ne.a,S()({},t,{title:a()(ce.a,{left:a()(se.a,{onClick:t.onClick,checked:r,size:16}),isMobile:o.isMobile,style:this.getSectionHeaderStyle()},void 0,e)}))}}),n()(this,"getEmptyState",()=>{const{device:e}=this.environment;return{key:"empty",action:()=>{},render:t=>d.a.createElement(ne.a,S()({},t,{title:a()(ce.a,{isMobile:e.isMobile,style:{fontSize:14,color:this.theme.mediumTextColor,padding:"2px 32px"}},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.selectPageStep.empty",defaultMessage:"No pages inside"}))}))}}),n()(this,"handleSearchQueryChange",e=>{const t=this.stores.searchStore.state,i=e.length>0;this.stores.searchStore.setState({...t,query:e,open:i})}),n()(this,"handleSearchCancel",()=>{const e=this.stores.searchStore.state;this.stores.searchStore.setState({...e,open:!1,query:void 0})})}renderComponent(){const{intl:e}=this.props,{selectedPageIdsStore:t,searchStore:i}=this.stores,{device:o}=this.environment;if(!this.sidebarState.state)return a()(B.a,{});const{allSharedPagesStores:r,showWorkspaceSection:n,showSharedSection:s,showPrivateSection:l,showOnlyPrivateSection:c}=this.sidebarState.state,{currentSpaceViewStore:h,currentSpaceStore:g}=b.default.state;if(!h||!g)return;const p=h.getWorkspacePages().filter(e=>e.state.value&&"copy_indicator"!==e.state.value.type),u=h.getPrivatePages(this.environment).filter(e=>e.state.value&&"copy_indicator"!==e.state.value.type),m=[...t.state].map(e=>new ae.a(this.environment,{table:ie.a,id:e})).filter(e=>!e.isTopLevelPrivatePage(g.id,this.environment)&&!e.isTopLevelWorkspacePage(g.id)&&!r.some(t=>t.id===e.id)),v=m.length>0,f=Object(x.getSpaceName)(this.environment,g),w=te.a.compact([v&&{key:"manual",render:e=>d.a.createElement(y.a,S()({},e,{title:a()(ce.a,{isMobile:o.isMobile,style:this.getSectionHeaderStyle()},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.pagePicker.manuallyAddedPagesSection.title",defaultMessage:"Manually added"})),isTitleUppercase:!0})),items:m.map(this.getPageItem)},n&&{key:"workspace",render:e=>d.a.createElement(y.a,e),items:te.a.compact([this.getPageSectionHeader(e.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.workspaceSection.title",defaultMessage:"Workspace",description:"This word is used in the same context as the title for the Workspace section of the sidebar."}),p),0===p.length&&this.getEmptyState(),...p.map(e=>this.getPageItem(e,1))])},s&&{key:"shared",render:e=>d.a.createElement(y.a,e),items:te.a.compact([this.getPageSectionHeader(e.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.sharedSection.title",defaultMessage:"Shared",description:"This word is used in the same context as the title for the Shared section of the sidebar."}),r),0===r.length&&this.getEmptyState(),...r.map(e=>this.getPageItem(e,1))])},l&&{key:"private",render:e=>d.a.createElement(y.a,e),items:te.a.compact([this.getPageSectionHeader(c?f||"":e.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.privateSection.title",defaultMessage:"Private",description:"This word is used in the same context as the title for the Private section of the sidebar."}),u),0===u.length&&this.getEmptyState(),...u.map(e=>this.getPageItem(e,1))])}]),P="on"===re.default.getGroup(this.environment,"oauth-page-search");return d.a.createElement(d.a.Fragment,null,P&&a()(me.a,{origin:a()(de.b,{focus:!0,focusAfterAnimation:!0,value:i.state.query||"",onChange:e=>{this.handleSearchQueryChange(e.target.value)},placeholder:e.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.search.placeholder",defaultMessage:"Search for pages in {workspaceName}"},{workspaceName:f})}),sameWidthAsOrigin:!0,popupType:me.a.PopupType.Popup,open:i.state.open,render:()=>a()(be,{spaceId:g.id,onSelectPage:e=>this.props.onClickPage(e,!1),query:i.state.query||"",source:"oauth"}),onDismiss:this.handleSearchCancel}),a()("div",{style:this.getPageListStyle()},void 0,a()(le.a,{type:le.a.Type.Vertical,sections:w,initialFocus:void 0})))}getSectionHeaderStyle(){return{textTransform:"uppercase",fontSize:12,fontWeight:600,color:this.theme.mediumTextColor,padding:"2px 0"}}getPageListStyle(){return{alignItems:"left",width:"100%",height:380,borderWidth:1,borderStyle:"solid",borderColor:H.g.contentBorder,overflowY:"auto"}}}var Pe=Object(k.injectIntl)(we);class ke extends c.a{constructor(...e){super(...e),n()(this,"storeTypes",{selectedPageIdsStore:F.a.of(new Set),botsRequestStore:R.a,authorizationStepStore:F.a.of("permissions")}),n()(this,"renderRequestResult",(e,t,i)=>{const{responseType:o,integrationId:r,intl:n}=this.props,{currentUserRootStore:s,currentSpaceStore:d,currentSpaceViewStore:l,currentUserSettingsStore:c}=b.default.state;if(!(s&&d&&l&&c))return;const h=Object(x.getSpaceName)(this.environment,d);if(!r||!Object(q.f)(r))return this.renderError({type:G.a.invalid_request,body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidClientId.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:(...e)=>a()($.a,{href:"https://developers.notion.com/#handling-errors"},void 0,e)}}),integration:void 0});const p=Object(L.c)(s,{table:O.a,id:r});if(!i||!p.isReady())return a()(B.a,{});if(!p.state.value)return this.renderError({type:G.a.invalid_request,body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.clientNotFound.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:(...e)=>a()($.a,{href:"https://developers.notion.com/#handling-errors"},void 0,e)}}),integration:p.state.value});if("code"!==o)return this.renderError({type:G.a.invalid_request,body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidResponseType",defaultMessage:"Missing or invalid response_type. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:(...e)=>a()($.a,{href:"https://developers.notion.com/#handling-errors"},void 0,e)},description:"Do not translate 'response_type', it's code."}),integration:p.state.value});if(e){const t=Object(V.b)(n,e),i=503===e.status?G.a.temporarily_unavailable:G.a.server_error;return this.renderError({type:i,body:t,integration:p.state.value})}if(t&&!e){const{botIds:e}=t,i=e.map(e=>Object(L.c)(s,{table:_.a,id:e}).getValue()).find(e=>(null==e?void 0:e.integration_id)===r);return i&&i.created_by_id!==s.id?this.renderError({type:G.a.access_denied,title:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.title",defaultMessage:"This integration has already been added to {workspaceName}",values:{workspaceName:h}}),body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.body",defaultMessage:"You can review and remove added integrations in Settings."}),integration:p.state.value,primaryAction:a()(g.a,{isLarge:!0,onClick:()=>{u.b({environment:this.environment,spaceViewStore:l,spaceStore:d,userSettingsStore:c,userRootStore:s})}},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.openWorkspaceSettingsButton.label",defaultMessage:"Open Settings"}))}):this.renderAuthorizationPage(p.state.value,null==i?void 0:i.id)}}),n()(this,"switchToPagePickerStep",()=>{this.stores.authorizationStepStore.setState("page_picker")}),n()(this,"switchToPermissionsStep",()=>{this.stores.authorizationStepStore.setState("permissions")}),n()(this,"handleCancel",e=>{u.a({environment:this.environment,params:this.props,integration:e,errorType:G.a.access_denied})}),n()(this,"handleAuthorize",(e,t)=>{u.a({environment:this.environment,params:this.props,integration:e,spaceId:t,initialBlockIdsForBot:Array.from(this.stores.selectedPageIdsStore.state)})}),n()(this,"handleClickPage",(e,t)=>{const{selectedPageIdsStore:i}=this.stores,o=i.state;t?o.delete(e):o.add(e),i.emit()}),n()(this,"handleClickSection",e=>{const{selectedPageIdsStore:t}=this.stores,i=t.state;e.every(e=>i.has(e.id))?e.forEach(e=>i.delete(e.id)):e.forEach(e=>i.add(e.id)),t.emit()})}willMount(){const{responseType:e,integrationId:t,redirectUri:i,state:o}=this.props;J.setOauthAuthorizationParams({responseType:e,integrationId:t,redirectUri:i,state:o})}async didMount(){const{currentSpaceStore:e,currentSpaceViewStore:t}=b.default.state;e&&t&&e.canAdmin()||await this.setCurrentSpaceToFirstAdminSpace()}renderComponent(){const{currentSpaceStore:e}=b.default.state;if(e)return a()("div",{style:this.getLayoutContainerStyle()},void 0,a()("div",{style:this.getPageContainerStyle()},void 0,a()("div",{style:this.getContentBoxStyle()},void 0,this.renderTopbar(),a()("div",{style:this.getContentBodyStyle()},void 0,a()(U.a,{requestStore:this.stores.botsRequestStore,request:{environment:this.environment,table:W.a,id:e.id,type:"guest"},performRequest:j.e,render:this.renderRequestResult})))))}renderAuthorizationPage(e,t){const{redirectUri:i}=this.props,{currentSpaceStore:o,currentSpaceViewStore:r}=b.default.state;if(!o||!r)return;const n=Object(x.getSpaceName)(this.environment,o);return o.state.value&&o.canAdmin()?Q.a(e,i)?"permissions"===this.stores.authorizationStepStore.state||t?this.renderPermissionsStep(e,o,t):this.renderPagePickerStep(e,o):this.renderError({type:G.a.invalid_request,body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidRedirectUri.body",defaultMessage:"Missing or invalid redirect_uri. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:(...e)=>a()($.a,{href:"https://developers.notion.com/#handling-errors"},void 0,e)},description:"Do not translate 'redirect_uri', it's code."}),integration:e}):this.renderError({type:G.a.access_denied,title:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.title",defaultMessage:"You're not allowed to add integrations to {workspaceName}",values:{workspaceName:n}}),body:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.body",defaultMessage:"Contact an admin to grant you admin access, or switch to another workspace."}),integration:e,primaryAction:a()(g.a,{isLarge:!0,onClick:()=>K.a.setState({...K.a.state,open:!0})},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.switchWorkspaceButton.label",defaultMessage:"Switch workspace"}))})}renderPermissionsStep(e,t,i){const o=Object(x.getSpaceName)(this.environment,t),r=e.info.website_url,n=e.info.terms_of_use_url,s=e.info.privacy_policy_url,c=e.info.icon?{pointer:{table:O.a,id:e.id},icon:e.info.icon}:void 0,g=this.props.redirectUri?this.props.redirectUri.replace("http://","").replace("https://","").split(/[/?#]/)[0]:void 0;return d.a.createElement(d.a.Fragment,null,a()("div",{style:{padding:15}},void 0,a()(Y.a,{icon:c,disabled:!0,title:e.name,size:54,isEmptyPage:!1,style:{margin:"auto"}})),a()("div",{style:this.getTitleStyle()},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.title",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> wants to access {workspaceName}",values:{integrationName:e.name,workspaceName:o,inlinetextlink:(...e)=>r?a()($.a,{style:{...this.getInlineTextLinkStyle(),fontWeight:h.a.fontWeight.semibold},href:r},void 0,e):e}})),a()("div",{style:{marginBottom:8}},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.intro",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> wants to",values:{integrationName:e.name,inlinetextlink:(...e)=>r?a()($.a,{href:r,style:this.getInlineTextLinkStyle()},void 0,e):e}})),a()(Me,{icon:l.a.pencil,title:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewAndEditPages",defaultMessage:"View and edit pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewAndEditPages.description",defaultMessage:"{integrationName} will be able to view and edit pages you select in the next step. You can also share pages later with the {integrationName} via the Share menu.",values:{integrationName:e.name,workspaceName:o}})),a()(Me,{icon:l.a.plus,title:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.addNewPages",defaultMessage:"Add new pages to {workspaceName}",values:{workspaceName:o},description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.addNewPages.details",defaultMessage:"{integrationName} will be able to add new pages inside pages it has access to.",values:{integrationName:e.name}})),a()(Me,{icon:l.a.settingsMembers,title:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers",defaultMessage:"View names and emails",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers.detail",defaultMessage:"{integrationName} will be able to see all workspace members and guests and their email addresses.",values:{integrationName:e.name}})),this.renderOptionButtons({leftText:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.cancelButton.label",defaultMessage:"Cancel"}),leftAction:()=>this.handleCancel(e),rightText:a()(k.FormattedMessage,i?{id:"oauthAuthorizationPage.permissionStep.finishButton.label",defaultMessage:"Allow access",description:"This button will complete OAuth early and redirect the user."}:{id:"oauthAuthorizationPage.permissionStep.continueButton.label",defaultMessage:"Select pages",description:"This button will take a user to a screen where they can choose pages to share with an integration."}),rightAction:i?()=>this.handleAuthorize(e,t.id):this.switchToPagePickerStep}),a()("footer",{style:this.getFooterStyle()},void 0,a()("div",{style:{color:this.theme.regularTextColor,fontWeight:h.a.fontWeight.semibold,marginBottom:4}},void 0," ",a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.title",defaultMessage:"Make sure you trust {integrationName} ({redirectUriDomain})",values:{integrationName:e.name,redirectUriDomain:g}})),a()("div",{},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.body",defaultMessage:"If you continue, you may be sharing sensitive information. Notion does not review third party integrations such as {integrationName}. Learn how {integrationName} handles your data by reviewing their <privacypolicylink>Privacy Policy</privacypolicylink> and <termsofservicelink>Terms of Service</termsofservicelink>.",values:{integrationName:e.name,privacypolicylink:(...e)=>s?a()($.a,{href:s},void 0,e):e,termsofservicelink:(...e)=>n?a()($.a,{href:n},void 0,e):e}}))))}renderPagePickerStep(e,t){return d.a.createElement(d.a.Fragment,null,a()("div",{style:this.getSubtitleStyle()},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.title",defaultMessage:"Allow {integrationName} to access these pages",values:{integrationName:e.name}})),a()(Pe,{onClickPage:this.handleClickPage,onClickSection:this.handleClickSection,selectedPageIdsStore:this.stores.selectedPageIdsStore}),this.renderOptionButtons({leftText:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.backButton.label",defaultMessage:"Back"}),leftAction:this.switchToPermissionsStep,rightText:a()(k.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.finishButton.label",defaultMessage:"Allow access",description:"This button, once clicked, adds an integration to a user's workspace and automatically gives it access to a set of pages the user selected."}),rightAction:()=>this.handleAuthorize(e,t.id)}))}renderTopbar(){const{selectedPageIdsStore:e}=this.stores,{isMobile:t}=this.environment.device;return a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",height:60,paddingLeft:20,paddingRight:8,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:H.g.contentBorder}},void 0,l.a.notionLogoStroked({width:t?28:30,height:t?28:30,marginRight:10,flexShrink:0}),a()("div",{style:{fontWeight:h.a.fontWeight.medium,fontSize:16}},void 0,"Notion"),a()("div",{style:{flexGrow:1,flexShrink:1}}),a()("div",{style:{flexShrink:0}},void 0,a()(N,{format:I.a.Regular,onSpaceClick:async({spaceViewStore:t})=>{e.setState(new Set),await E.w({environment:this.environment,spaceViewStore:t})},shouldShowUnexpandButton:!1,disableLoginLink:!0,buttonStyle:{borderRadius:3,marginBottom:0}})))}renderOptionButtons(e){return a()("div",{style:this.getButtonGroupStyle()},void 0,a()(p.a,{isLarge:!0,onClick:e.leftAction,style:{height:32}},void 0,e.leftText),a()(g.a,{isLarge:!0,onClick:e.rightAction},void 0,e.rightText))}renderError({integration:e,type:t,title:i,body:o,primaryAction:r}){const n=i||a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.genericError.title",defaultMessage:"Something went wrong"});return a()("section",{style:this.getErrorContainerStyle()},void 0,l.a.genericError(this.getErrorIconStyle()),a()("header",{style:{...this.getTitleStyle(),marginBottom:12}},void 0,n),o&&a()("p",{style:this.getErrorBodyStyle()},void 0,o),r&&a()("div",{style:this.getErrorBodyStyle()},void 0,r),a()(p.a,{onClick:()=>{u.a({environment:this.environment,integration:e,errorType:t,params:this.props})}},void 0,a()(k.FormattedMessage,{id:"oauthAuthorizationPage.error.cancelButton.label",defaultMessage:"Cancel"})))}async setCurrentSpaceToFirstAdminSpace(){const{currentUserRootStore:e}=b.default.state;if(e){const t=e.getSpaceViewStores();if(t.length>0){const e=t.find(e=>e.canAdmin());return void(await E.w({environment:this.environment,spaceViewStore:e||t[0]}))}}X.navigate({environment:this.environment,url:Z.d.login,redirect:!0})}getLayoutContainerStyle(){const{WindowSizeStore:e}=this.environment;return{height:"100%",overflow:"auto",backgroundColor:e.state.width>500?H.g.frontCreamBackground:H.g.white}}getPageContainerStyle(){return{display:"flex",justifyContent:"center"}}getContentBoxStyle(){const{WindowSizeStore:e}=this.environment,t=e.state.width>500,i=e.state.height<600?16:t?"calc((100vh - 600px) / 2)":0,o=t?this.theme.lightBoxShadow:"none";return{width:"500px",minHeight:"600px",borderRadius:5,backgroundColor:H.g.white,boxShadow:o,display:"flex",flexDirection:"column",fontSize:h.a.fontSize.UIRegular.desktop,marginTop:i,transition:"all 0.2s ease"}}getContentBodyStyle(){return{paddingLeft:40,paddingRight:40,paddingTop:25,paddingBottom:25,flex:1,display:"flex",flexDirection:"column"}}getFooterStyle(){return{fontSize:h.a.fontSize.UISmall.desktop,color:this.theme.mediumTextColor,paddingTop:32,paddingBottom:16}}getTitleStyle(){const{device:e}=this.environment;return{fontSize:e.isMobile?18:20,margin:"0 50px 32px",textAlign:"center",fontWeight:h.a.fontWeight.medium}}getSubtitleStyle(){return{fontSize:14,textAlign:"center",fontWeight:h.a.fontWeight.medium,marginBottom:16}}getButtonGroupStyle(){return{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:24}}getErrorContainerStyle(){return{textAlign:"center",flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}getErrorIconStyle(){const{device:e}=this.environment,t=e.isMobile?25:48;return{fill:H.g.red,width:t,height:t,marginBottom:20,display:"inline-block"}}getErrorBodyStyle(){return{marginTop:0,marginBottom:24,width:"80%"}}getInlineTextLinkStyle(){return{borderBottom:"1px solid rgba(54, 53, 47, 0.2)",color:"black",textDecoration:"none"}}}function Me(e){const[t,i]=Object(s.useState)(!1),o=Object(D.a)(e=>({permissionItem:{display:"flex",justifyContent:"space-between",padding:"6px 0",cursor:"pointer",userSelect:"none"},permissionItemHeading:{display:"flex",alignItems:"center"},permissionItemDetails:{paddingLeft:32,transition:"all 0.2s ease",color:e.mediumTextColor},rightStyle:{width:22,height:18},sharedIconStyle:{width:24,height:16,textAlign:"center",marginRight:8}}),[]);return d.a.createElement(d.a.Fragment,null,a()("div",{style:o.permissionItem,onClick:()=>i(!t)},void 0,a()("div",{style:o.permissionItemHeading},void 0,a()("div",{style:o.sharedIconStyle},void 0,e.icon({width:16,height:16,color:H.g.regularIconColor})),a()("div",{},void 0,e.title)),e.children&&a()("div",{},void 0,l.a.chevronDownThin({width:12,height:12,color:H.g.lightIconColor,transform:t?"rotate(180deg)":void 0,transition:"transform 0.2s ease"}))),a()("div",{style:{...o.permissionItemDetails,opacity:t?1:0,flex:t?1:0,paddingBottom:t?8:0,transform:t?"translate3d(0,-4px,0)":"translate3d(0,-8px,0)"}},void 0,t&&e.children))}t.default=Object(k.injectIntl)(ke)}}]);